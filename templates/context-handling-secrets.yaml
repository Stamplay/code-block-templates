name: Handling secrets
type: sample
author:
  name: claudio.petrini
  link: https://github.com/claudiopetrini
order: 9
description: |
  How to access secrets in Code Blocks.
meta:
  wt-editor: https://cdn.auth0.com/webtask-editor/editors/1/function-editor.js
  wt-editor-language: javascript
  wt-editor-template-instructions: |
    Since the server side of an application is the one that keeps passwords, tokens and connections string the CodeBlocks allows you to store this kind of informations securely by using the secret area in the Editor.
    All the secrets stored in that area are saved encrypted and you can use it in your Codeblock by accessing to context.secrets.yourKey. Please avoid to return these values to the client.
    In this example we're making an HTTP request with the authorization header using a password stored securely in the key named secretKey.
  wt-node-dependencies: |
    { "request": "2.85.0"}
code: |
    const request = require('request');
    const url = 'https://codeblocks.stamplayapp.com/api/webhook/v1/get/catch';

    module.exports = function (context, cb) {
      const password = context.secrets.secretKey;
      return request(url, cb)
        .auth('username', password);
    };
secrets:
  secretKey : 'secret'
body:
  parse: true
  merge: true
